---
title: "DIABETIC RETINOPATHY PREDICTION USING DEEP LEARNING"
author: "Aleena Alby"
date: "22/10/2022"
output: 
    pdf_document:
      number_sections: true
bibliography: /Users/aleenaalby/Desktop/Diabetic-Retinopathy-detection/Documentation/references.bib 
link-citations: true
---

\newpage

**Declaration of Originality**

I declare that this project is all my own work and has not been copied in part or in whole from any other source except where duly acknowledged. As such, all use of previously published work (from books, journals, magazines, internet etc.) has been acknowledged by citation within the main report to an item in the References or Bibliography lists. I also agree that an electronic copy of this project may be stored and used for the purposes of plagiarism prevention and detection.

**Statement of copyright**

I acknowledge that the copyright of this project report, and any product developed as part of the project, belong to Coventry University. Support, including funding, is available to commercialise products and services developed by staff and students. Any revenue that is generated is split with the inventor/s of the product or service. For further information please see [www.coventry.ac.uk/ipr](http://www.coventry.ac.uk/ipr) or contact [ipr\@coventry.ac.uk](mailto:ipr@coventry.ac.uk){.email}.

**Statement of ethical engagement**

I declare that a proposal for this project has been submitted to the Coventry University ethics monitoring website (<https://ethics.coventry.ac.uk/>) and that the application number is listed below (Note: Projects without an ethical application number will be rejected for marking)

\[Signed:\]{AleenaAlby} [Date:]{.ul}

Please complete all fields.

+--------------------------------------------------------+
| First Name: Aleena                                     |
+:=======================================================+
| Last Name: Alby                                        |
+--------------------------------------------------------+
| Student ID number                                      |
+--------------------------------------------------------+
| Ethics Application Number                              |
+--------------------------------------------------------+
| 1^st^ Supervisor Name Prof James Brusey                |
+--------------------------------------------------------+
| 2^nd^ Supervisor Name                                  |
+--------------------------------------------------------+

```{=html}
<!--  **This form must be completed, scanned and included with your project
submission to Turnitin. Failure to append these declarations may result
in your project being rejected for marking.** -->
```
```{=tex}
\pagebreak
\tableofcontents
\pagebreak
```
# Abstract

# Introduction

One of the major causes of eye vision loss is diabetes. While delayed examination would have a higher effect on the retinal area of the eye, early detection of diabetes is crucial.

## Background to the Project

## Project Objectives

## Overview of This Report

# Literature Review

In recent years, numerous deep learning based automatic DR detection systems have emerged. In this section, some of the recent research projects have been addressed.

Using transfer learning, Esra Kaya and Ismail Saritas created CNN for the identification of diabetic retinopathy [@9828576]. They utilised the DRIVE dataset (Digital Retinal Images for Vessel Extraction). They utilised contrast-limited adaptive histogram equalisation to improve the clarity of the image. They assessed the ResNet18, GoogleNet, and SqueezeNet CNN architectures' performances as feature extraction techniques and classifiers. ResNet18 was discovered to be the most effective architecture as a classifier with 100% accuracy.

Fundus images from the Kaggle opensource dataset were used by Nikhil Sathya Kumar and Dr. B. Ramaswamy Karthikeyan to identify DR using CNNs, Transformers, and MLPs [@9651024]. The findings show that, in comparison to CNN and MLP based models, Transformer based models were more accurate. The most accurate Transformer-based model was Swin with 92.49% accuracy.

ImageNet model was proposed by Jayakumari.C et al [@9215270]. The model's training accuracy was 98.6%.

\newpage

+--------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------+
| Methods & Ref                        | Datasets Used                                                                  | Techniques                                                         | Performance metrics                                                                                                                  |
+======================================+:===============================================================================+====================================================================+======================================================================================================================================+
| **CNN** [@9828576]                   | DRIVE dataset (40 images in the database were chosen randomly from 400 images) | They assessed the ResNet18, GoogleNet, and SqueezeNet              | ResNet18 - 100 %, GoogleNet - 68.2 %, SqueezeNet - 67.4 %                                                                            |
+--------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------+
| **CNN**, MLP & Transfomer [@9651024] | Aptos dataset from Kaggle (6590 Images)                                        | \| EfficientNet, ResNet, MLP-Mixer, ViT , ViT+MLP, Swin and Swin+V | iT \| EfficientNet -91.18 %, ResNet - 89.63%, MLP-Mixer - 94.47%, ViT - 91.13 %, ViT+MLP - 89.73%, Swin - 92.49%, Swin+ViT - 91.91 % |
+--------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------+
| **ImageNet** [@9215270]              | Kaggle Dataset                                                                 | ImageNet                                                           | 98.6%                                                                                                                                |
+--------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------+

: DR detection methods

\pagebreak

# Methodology

## *Dataset*

For this research project I'm using dataset available at Kaggle[@diabetica_data]. This Retinal images were provided by EyePACS. The dataset containing large set of high-resolution retina images taken under a variety of imaging conditions. For each image, a left and right field is provided. Images are identified by a image id and either the left or right eye (for example, 1 left.jpeg represents the patient number 1's left eye).

+---------------+--------+-----------------------------------------------------------------------------------------------------------------------------------+
| DR classes    | Level  | Description                                                                                                                       |
+===============+========+===================================================================================================================================+
| No DR         | 0      | Healthy Retina (Normal)                                                                                                           |
+---------------+--------+-----------------------------------------------------------------------------------------------------------------------------------+
| Mild          | 1      | Retina with tiny bulges (microaneurysms)                                                                                          |
+---------------+--------+-----------------------------------------------------------------------------------------------------------------------------------+
| Moderate      | 2      | Retina with microaneurysms, higher risk of developing vision problems in the future                                               |
+---------------+--------+-----------------------------------------------------------------------------------------------------------------------------------+
| Severe        | 3      | Retina with severe and widespread microaneurysms, including bleeding into the retina                                              |
+---------------+--------+-----------------------------------------------------------------------------------------------------------------------------------+
| Proliferative | 4      | New blood vessels and scar tissue have formed on your retina, which can cause significant bleeding and lead toÂ retinal detachment |
+---------------+--------+-----------------------------------------------------------------------------------------------------------------------------------+

: [@diabetic2017]

![Normal Retina Vs Diabetic Retinopathy Retina [@diabetica]](images/image%201.jpg "Normal Retina Vs Diabetic retinopathy Retina [@diabetica]"){width="400" height="300"}

## *Data pre-processing*

Image pre-processing was performed with the aim to decrease unclear image and reduce image size. The plot below illustrates the class imbalance in the original dataset.

![Sum of number of records for each level](images/LevelsOfDR.png){width="343"}

The dataset consist of 35,126 set of images. The orginal image have 1944 \* 2592 \* 3 size, and all images are jpeg format. The classes have an uneven distribution of images.

\pagebreak

1.  Image Resizing

    Due to the enormous size of the dataset, it was drastically downsized before being sent to the network. Each input image is 256 \* 256 in size after resizing.

2.  Removing Unclear Image

    Some images have a blackish or white tint. Because it might affect the outcome, this type of image cannot be fed into the network. The removal of an unclear image is a crucial step that must be taken.

3.  Dividing images into classes

    Images are classified into 5 folders based on the DR levels.

\pagebreak

# Requirements

# Analysis

# Design

# Implementation

# Testing

# Project Management

## Project Schedule

## Risk Management

## Quality Management

## Social, Legal, Ethical and Professional Considerations

# Critical Appraisal

# Conclusions

## Achievements

## Future Work

# Student Reflections

\newpage

# References

::: {#refs}
:::

\newpage

Appendix A -- Project Specification

Appendix B -- Interim Progress Report and Meeting Records

Appendix C -- Requirements Specification Document

Appendix D -- User Manual

Appendix E -- Project Presentation

Appendix F -- Certificate of Ethics Approval
